name: Borussia News Auto Poster

on:
  schedule:
    - cron: '0 2 * * *' # 한국 시간 11시
  workflow_dispatch:

# 지적하신 대로 최상단(Workflow 레벨)으로 이동
permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      # (기존 파이썬 설치 및 라이브러리 설치 단계들...)

      - name: Install Playwright Browsers & Deps
        run: playwright install --with-deps chromium
        
      # (뉴스 수집 및 업로드 실행...)
      
      - name: Commit and Push Changes
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add processed_titles.txt
          git commit -m "Update history [skip ci]" || echo "No changes to commit"
          git push
        git config --global user.email "github-actions[bot]@users.noreply.github.com"
        git add processed_titles.txt
        # 변경사항이 있을 때만 커밋 (중복 방지용 히스토리 업데이트)
        git commit -m "Update news history [skip ci]" || echo "No changes to commit"
        git push
